# Доступ к данным

Существует 4 места, где могут храниться используемые данные:

* Литералы.
* Переменные.
* Элементы массивов.
* Члены объектов.

## Управление областью видимости

### Цепочки областей видимости и разрешение идентификаторов

Области видимости функции определяет внутренее свойство `[[Scope]]`, которое содержит коллекцию объектов, представляющую области видимости, в которой была создана функция. Эта коллекция называется цепочкой областей видимости. Каждый объект в этой цепочке называется *объектом переменных*, и каждый из них содержит пары ключ/значение, представляющие переменные. При создании функции ее цепочка областей видимости заполняется объектами, представляющими данные, доступные в той области видимости, где была создана функция.

При вызове функции создается внутренний объект, который называется *контекстом выполнения*. Каждый контекст выполнения является уникальным для данного конкретного вызова функции. Объект контекста выполнения уничтожается, как только завершится выполнение функции.

При создании контекста выполнения его цепочка областей видимости инициализируется объектами, содержащимися в свойстве `[[Scope]]` выполняемой функции. Они копируются в цепочку областей видимости контекста выполнения в порядке их появления в функции. После выполнения этой операции для контекста выполнения создается новый объект, который называется объектом активации, который содержит все локальные переменные, именованные аргументы, коллекцию `arguments` и ссылку `this`. Затем данный объект помещается в начало цепочки областей видимости. При уничтожении контекста выполнения уничтожается и объект активации.

Каждый раз, когда при выполнении функции интерпретатор встречает ссылку на переменную, он выполняет процедуру разрешения идентификатора, чтобы определить, откуда извлекать или где сохранять данные. Поиск начинается с начала цепочки областей видимости в объекте активации контекста выполнения. Затем поиск производится в каждом объекте переменных. Поиск продолжается, пока не будет найдена переменная с требуемым идентификатором или пока в цепочке не останется объектов.

### Производительность разрешения идентификаторов

Чем грубже в цепочке областей видимости находится переменная, тем больше времени уходит на ее поиск.

### Увеличение цепочки областей видимости

Необходимо стараться не использовать инструкцию `with`.

### Динамические области видимости

Инструкция `with`, предложение `catch` в инструкции `try-catch`, а также функция, содержащая вызов функции `eval()`, обладают *динамическими областями видимости*. Они существуют только во время выполнения программного кода и поэтому не обнаруживаются при простом статическом анализе.

Динамичесике области видимости замедляют разрешение идентификаторов, поэтому рекомендуется использовать динамические области видимости, только когда это действительно необходимо.

### Замыкания, области видимости и память

К замыканиям следует относиться с осторожностью, так как их использование ведет к увеличению потребления памяти и снижению производительности. Смегчить отрицательное влияние на производительность можно, сохраняя ссылки на внешние переменные в локальной области видимости.

## Члены объектов

### Прототипы

Объекты могут иметь свойства двух типов: собственные свойства и свойства прототипа.

Метод `hasOwnProperty` выполняет поиск только в самом объекте, оператор `in` - и в объекте, и в цепочке прототипов.

### Цепочки прототипов

Поиск членов экземпляров в любом случае выполняется медленнее, чем поиск в литералах или локальных переменных, а поиск в цепочке прототипов только ухужшает ситуацию.

### Вложенные члены

Чем глубже вложенность обращения, тем дольше оно выполняется.

В большинстве браузеров особого различия в производительности операций доступа с точкой и квадратными скобками не наблюдается.

### Кэширование значений членов объектов

Учитывая проблемы производительности доступа к объектам, необходимо использовать его только при крайней необходимости.